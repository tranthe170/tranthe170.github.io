<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.133.0">
    <meta name="description" content="">
<meta name="author" content="journeyoftheaverageguy@gmail.com">

    <link rel="icon" href="../images/favicon.png" type="image/png">

    <title>Glue ETL Job :: AWS System Manager</title>

    
    <link href="../css/nucleus.css?1725123472" rel="stylesheet">
    <link href="../css/fontawesome-all.min.css?1725123472" rel="stylesheet">
    <link href="../css/hybrid.css?1725123472" rel="stylesheet">
    <link href="../css/featherlight.min.css?1725123472" rel="stylesheet">
    <link href="../css/perfect-scrollbar.min.css?1725123472" rel="stylesheet">
    <link href="../css/auto-complete.css?1725123472" rel="stylesheet">
    <link href="../css/atom-one-dark-reasonable.css?1725123472" rel="stylesheet">
    <link href="../css/theme.css?1725123472" rel="stylesheet">
    <link href="../css/hugo-theme.css?1725123472" rel="stylesheet">
    
    <link href="../css/theme-workshop.css?1725123472" rel="stylesheet">
    
    

    <script src="../js/jquery-3.3.1.min.js?1725123472"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
    </style>
    
  </head>
  <body class="" data-url="../4-etl-pipelines/">
    <nav id="sidebar" class="showVisitedLinks">



  <div id="header-wrapper">
    <div id="header">
      <a id="logo" href="../">

<svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 60 30" width="30%"><defs><style>.cls-1{fill:#fff;}.cls-2{fill:#f90;fill-rule:evenodd;}</style></defs><title>AWS-Logo_White-Color</title><path class="cls-1" d="M14.09,10.85a4.7,4.7,0,0,0,.19,1.48,7.73,7.73,0,0,0,.54,1.19.77.77,0,0,1,.12.38.64.64,0,0,1-.32.49l-1,.7a.83.83,0,0,1-.44.15.69.69,0,0,1-.49-.23,3.8,3.8,0,0,1-.6-.77q-.25-.42-.51-1a6.14,6.14,0,0,1-4.89,2.3,4.54,4.54,0,0,1-3.32-1.19,4.27,4.27,0,0,1-1.22-3.2A4.28,4.28,0,0,1,3.61,7.75,6.06,6.06,0,0,1,7.69,6.46a12.47,12.47,0,0,1,1.76.13q.92.13,1.91.36V5.73a3.65,3.65,0,0,0-.79-2.66A3.81,3.81,0,0,0,7.86,2.3a7.71,7.71,0,0,0-1.79.22,12.78,12.78,0,0,0-1.79.57,4.55,4.55,0,0,1-.58.22l-.26,0q-.35,0-.35-.52V2a1.09,1.09,0,0,1,.12-.58,1.2,1.2,0,0,1,.47-.35A10.88,10.88,0,0,1,5.77.32,10.19,10.19,0,0,1,8.36,0a6,6,0,0,1,4.35,1.35,5.49,5.49,0,0,1,1.38,4.09ZM7.34,13.38a5.36,5.36,0,0,0,1.72-.31A3.63,3.63,0,0,0,10.63,12,2.62,2.62,0,0,0,11.19,11a5.63,5.63,0,0,0,.16-1.44v-.7a14.35,14.35,0,0,0-1.53-.28,12.37,12.37,0,0,0-1.56-.1,3.84,3.84,0,0,0-2.47.67A2.34,2.34,0,0,0,5,11a2.35,2.35,0,0,0,.61,1.76A2.4,2.4,0,0,0,7.34,13.38Zm13.35,1.8a1,1,0,0,1-.64-.16,1.3,1.3,0,0,1-.35-.65L15.81,1.51a3,3,0,0,1-.15-.67.36.36,0,0,1,.41-.41H17.7a1,1,0,0,1,.65.16,1.4,1.4,0,0,1,.33.65l2.79,11,2.59-11A1.17,1.17,0,0,1,24.39.6a1.1,1.1,0,0,1,.67-.16H26.4a1.1,1.1,0,0,1,.67.16,1.17,1.17,0,0,1,.32.65L30,12.39,32.88,1.25A1.39,1.39,0,0,1,33.22.6a1,1,0,0,1,.65-.16h1.54a.36.36,0,0,1,.41.41,1.36,1.36,0,0,1,0,.26,3.64,3.64,0,0,1-.12.41l-4,12.86a1.3,1.3,0,0,1-.35.65,1,1,0,0,1-.64.16H29.25a1,1,0,0,1-.67-.17,1.26,1.26,0,0,1-.32-.67L25.67,3.64,23.11,14.34a1.26,1.26,0,0,1-.32.67,1,1,0,0,1-.67.17Zm21.36.44a11.28,11.28,0,0,1-2.56-.29,7.44,7.44,0,0,1-1.92-.67,1,1,0,0,1-.61-.93v-.84q0-.52.38-.52a.9.9,0,0,1,.31.06l.42.17a8.77,8.77,0,0,0,1.83.58,9.78,9.78,0,0,0,2,.2,4.48,4.48,0,0,0,2.43-.55,1.76,1.76,0,0,0,.86-1.57,1.61,1.61,0,0,0-.45-1.16A4.29,4.29,0,0,0,43,9.22l-2.41-.76A5.15,5.15,0,0,1,38,6.78a3.94,3.94,0,0,1-.83-2.41,3.7,3.7,0,0,1,.45-1.85,4.47,4.47,0,0,1,1.19-1.37A5.27,5.27,0,0,1,40.51.29,7.4,7.4,0,0,1,42.6,0a8.87,8.87,0,0,1,1.12.07q.57.07,1.08.19t.95.26a4.27,4.27,0,0,1,.7.29,1.59,1.59,0,0,1,.49.41.94.94,0,0,1,.15.55v.79q0,.52-.38.52a1.76,1.76,0,0,1-.64-.2,7.74,7.74,0,0,0-3.2-.64,4.37,4.37,0,0,0-2.21.47,1.6,1.6,0,0,0-.79,1.48,1.58,1.58,0,0,0,.49,1.18,4.94,4.94,0,0,0,1.83.92L44.55,7a5.08,5.08,0,0,1,2.57,1.6A3.76,3.76,0,0,1,47.9,11a4.21,4.21,0,0,1-.44,1.93,4.4,4.4,0,0,1-1.21,1.47,5.43,5.43,0,0,1-1.85.93A8.25,8.25,0,0,1,42.05,15.62Z"></path><path class="cls-2" d="M45.19,23.81C39.72,27.85,31.78,30,25,30A36.64,36.64,0,0,1,.22,20.57c-.51-.46-.06-1.09.56-.74A49.78,49.78,0,0,0,25.53,26.4,49.23,49.23,0,0,0,44.4,22.53C45.32,22.14,46.1,23.14,45.19,23.81Z"></path><path class="cls-2" d="M47.47,21.21c-.7-.9-4.63-.42-6.39-.21-.53.06-.62-.4-.14-.74,3.13-2.2,8.27-1.57,8.86-.83s-.16,5.89-3.09,8.35c-.45.38-.88.18-.68-.32C46.69,25.8,48.17,22.11,47.47,21.21Z"></path></svg>

</a>

    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="../js/lunr.min.js?1725123472"></script>
<script type="text/javascript" src="../js/auto-complete.js?1725123472"></script>
<script type="text/javascript">
    
        var baseurl = "\/";
    
</script>
<script type="text/javascript" src="../js/search.js?1725123472"></script>

    
  </div>

    <div class="highlightable">
    <ul class="topics">

        
          
          




 
  
    
    <li data-nav-id="/1-introduce/" title="Introduction to Glue ETL Service" class="dd-item 
        
        
        
        ">
      <a href="../1-introduce/">
          <b>1. </b>Introduction to Glue ETL Service
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/2-eda/" title="Exploratory Data Analysis" class="dd-item 
        
        
        
        ">
      <a href="../2-eda/">
          <b>2. </b>Exploratory Data Analysis
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/3-preparation/" title="Preparation Steps" class="dd-item 
        
        
        
        ">
      <a href="../3-preparation/">
          <b>3. </b>Preparation Steps
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/3-preparation/3.1-s3-bucket/" title="Prepare S3 Bucket" class="dd-item 
        
        
        
        ">
      <a href="../3-preparation/3.1-s3-bucket/">
          <b>3.1. </b>Prepare S3 Bucket
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/3-preparation/3.2-aws-glue/" title="Prepare AWS Glue" class="dd-item 
        
        
        
        ">
      <a href="../3-preparation/3.2-aws-glue/">
          <b>3.2. </b>Prepare AWS Glue
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/3-preparation/3.3-athena/" title="Query with Athena" class="dd-item 
        
        
        
        ">
      <a href="../3-preparation/3.3-athena/">
          <b>3.3. </b>Query with Athena
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/3-preparation/3.4-quicksight/" title="Visualizing Data with Amazon QuickSight" class="dd-item 
        
        
        
        ">
      <a href="../3-preparation/3.4-quicksight/">
          <b>3.4. </b>Visualizing Data with Amazon QuickSight
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/4-etl-pipelines/" title="Glue ETL Job" class="dd-item 
        
        active
        
        ">
      <a href="../4-etl-pipelines/">
          <b>4. </b>Glue ETL Job
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/5-clean-up/" title="Clean Up Resources" class="dd-item 
        
        
        
        ">
      <a href="../5-clean-up/">
          <b>5. </b>Clean Up Resources
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

          
         
    </ul>

    
    
      <section id="shortcuts">
        <h3>More</h3>
        <ul>
          
              <li> 
                  <a class="padding" href="https://www.facebook.com/groups/awsstudygroupfcj/"><i class='fab fa-facebook'></i> AWS Study Group</a>
              </li>
          
        </ul>
      </section>
    

    
    <section id="prefooter">
      <hr/>
      <ul>
      
        <li>
          <a class="padding">
            <i class="fas fa-language fa-fw"></i>
          <div class="select-style">
            <select id="select-language" onchange="location = this.value;">
          
          
          
              
              
                  
                    
                    
                      <option id="en" value="/4-etl-pipelines/" selected>English</option>
                    
                  
              
                  
              
          
        </select>
        <svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
          width="255px" height="255px" viewBox="0 0 255 255" style="enable-background:new 0 0 255 255;" xml:space="preserve">
          <g>
            <g id="arrow-drop-down">
              <polygon points="0,63.75 127.5,191.25 255,63.75 		" />
            </g>
          </g>
        </svg>
        </div>
        </a>
        </li>
      
      
      
        <li><a class="padding" href="#" data-clear-history-toggle=""><i class="fas fa-history fa-fw"></i> Clear History</a></li>
      
      </ul>
    </section>
    
    <section id="footer">
      <left>
    
     <b> Workshop</b> <br>
    <img src="https://hitwebcounter.com/counter/counter.php?page=7920860&style=0038&nbdigits=9&type=page&initCount=0" title="Migrate" Alt="web counter"   border="0" /></a>  <br>
     <b> <a href="https://cloudjourney.awsstudygroup.com/">Cloud Journey</a></b> <br>
    <img src="https://hitwebcounter.com/counter/counter.php?page=7830807&style=0038&nbdigits=9&type=page&initCount=0" title="Total CLoud Journey" Alt="web counter"   border="0"   />
     
</left>
<left>
    <br>
    <br>
        <b> Last Updated </b> <br>
        <i><font color=orange>30-01-2022</font></i>
    </left>
    <left>
        <br>
        <br>
            <b> Team </b> <br>
           
            <i> <a href="https://www.linkedin.com/in/sutrinh/"  style="color:orange">Sử Trịnh  </a> <br>
                <a href="https://www.linkedin.com/in/jotaguy"  style="color:orange">Gia Hưng </a> <br>
                <a href="https://www.linkedin.com/in/hiepnguyendt"  style="color:orange">Thanh Hiệp </a>
               
        </i>
        </left>

<script async defer src="https://buttons.github.io/buttons.js"></script>

    </section>
  </div>
</nav>




        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            <a href='../'>Welcome to the AWS Workshop</a> > Glue ETL Job
          
        
          
        
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
  <ul>
    <li><a href="#dataset-issues">Dataset Issues</a></li>
    <li><a href="#etl-script-overview">ETL Script Overview</a></li>
    <li><a href="#explanation-of-the-etl-process">Explanation of the ETL Process</a></li>
    <li><a href="#conclusion">Conclusion</a></li>
  </ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
        <div id="body-inner">
          
            <h1>
              
              Glue ETL Job
            </h1>
          

        



	<h1 id="glue-etl-job-handling-data-issues">Glue ETL Job: Handling Data Issues</h1>
<p>In this section, we&rsquo;ll demonstrate how to process a dataset using an AWS Glue ETL job, addressing common data quality issues and transforming the data into a clean, analysis-ready format.</p>
<h2 id="dataset-issues">Dataset Issues</h2>
<p>The university rankings dataset has several issues that need to be addressed before it can be used effectively for analysis:</p>
<ol>
<li><strong>Missing or Incomplete Data</strong>: Some records have missing or incomplete fields such as the year, rank, score, or student-faculty ratio.</li>
<li><strong>Inconsistent Formatting</strong>: Data fields like <code>international_students</code> and <code>faculty_count</code> might contain non-numeric characters (e.g., commas or dots) that need to be cleaned.</li>
<li><strong>Inconsistent Data Types</strong>: Fields like <code>rank_display</code> may contain ranges (e.g., &ldquo;101-150&rdquo;), which need to be split and converted into integers for analysis.</li>
</ol>
<h2 id="etl-script-overview">ETL Script Overview</h2>
<p>The following script demonstrates how to address these issues using AWS Glue. The script reads the data from the Glue Data Catalog, cleans and transforms it, and then writes the cleaned data back to S3.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> sys
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> awsglue.transforms <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> awsglue.utils <span style="color:#f92672">import</span> getResolvedOptions
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> pyspark.context <span style="color:#f92672">import</span> SparkContext
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> awsglue.context <span style="color:#f92672">import</span> GlueContext
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> awsglue.job <span style="color:#f92672">import</span> Job
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> awsglue.dynamicframe <span style="color:#f92672">import</span> DynamicFrame
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>sc <span style="color:#f92672">=</span> SparkContext<span style="color:#f92672">.</span>getOrCreate()
</span></span><span style="display:flex;"><span>glueContext <span style="color:#f92672">=</span> GlueContext(sc)
</span></span><span style="display:flex;"><span>spark <span style="color:#f92672">=</span> glueContext<span style="color:#f92672">.</span>spark_session
</span></span><span style="display:flex;"><span>job <span style="color:#f92672">=</span> Job(glueContext)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Read data from Glue catalog</span>
</span></span><span style="display:flex;"><span>university_ranking_source <span style="color:#f92672">=</span> glueContext<span style="color:#f92672">.</span>create_dynamic_frame<span style="color:#f92672">.</span>from_catalog(
</span></span><span style="display:flex;"><span>    database<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;demo_db&#34;</span>,
</span></span><span style="display:flex;"><span>    table_name<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;university_ranking_csv&#34;</span>,
</span></span><span style="display:flex;"><span>    transformation_ctx<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;UniversityRanking_Source&#34;</span>,
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Print the schema to understand the structure of the dataset</span>
</span></span><span style="display:flex;"><span>university_ranking_source<span style="color:#f92672">.</span>printSchema()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Convert DynamicFrame to DataFrame for SQL operations</span>
</span></span><span style="display:flex;"><span>rankings_df <span style="color:#f92672">=</span> university_ranking_source<span style="color:#f92672">.</span>toDF()
</span></span><span style="display:flex;"><span>rankings_df<span style="color:#f92672">.</span>show(<span style="color:#ae81ff">5</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Register the DataFrame as a temporary SQL view for transformation</span>
</span></span><span style="display:flex;"><span>rankings_df<span style="color:#f92672">.</span>createOrReplaceTempView(<span style="color:#e6db74">&#34;university_ranking&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Perform data cleanup and transformation</span>
</span></span><span style="display:flex;"><span>clean_rankings_df <span style="color:#f92672">=</span> spark<span style="color:#f92672">.</span>sql(<span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    SELECT 
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        university,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        COALESCE(INT(year), 9999) AS year,  -- Handle missing years
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        rank_display,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        COALESCE(INT(SPLIT(rank_display, &#39;-&#39;)[0]), 9999) AS n_rank,  -- Split and convert rank ranges to integers
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        COALESCE(FLOAT(score), -1) AS score,  -- Handle missing scores
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        country, city, region, type,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        research_output,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        COALESCE(FLOAT(student_faculty_ratio), -1) AS student_faculty_ratio,  -- Handle missing student-faculty ratios
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        COALESCE(INT(REGEXP_REPLACE(international_students, &#39;[.,]&#39;, &#39;&#39;)), -1) AS international_students,  -- Clean and convert international students
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        size,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        COALESCE(INT(REGEXP_REPLACE(faculty_count, &#39;[.,]&#39;, &#39;&#39;)), -1) AS faculty_count  -- Clean and convert faculty count
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    FROM university_ranking
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;&#34;&#34;</span>)
</span></span><span style="display:flex;"><span>clean_rankings_df<span style="color:#f92672">.</span>show(<span style="color:#ae81ff">5</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Convert the cleaned DataFrame back to DynamicFrame</span>
</span></span><span style="display:flex;"><span>clean_dynamic_frame <span style="color:#f92672">=</span> DynamicFrame<span style="color:#f92672">.</span>fromDF(clean_rankings_df, glueContext, <span style="color:#e6db74">&#34;university_ranking_clean&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Write the cleaned data back to S3</span>
</span></span><span style="display:flex;"><span>s3output <span style="color:#f92672">=</span> glueContext<span style="color:#f92672">.</span>getSink(
</span></span><span style="display:flex;"><span>  path<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;s3://aws-glue-simple-demo/university_ranking/clean&#34;</span>,
</span></span><span style="display:flex;"><span>  connection_type<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;s3&#34;</span>,
</span></span><span style="display:flex;"><span>  updateBehavior<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;UPDATE_IN_DATABASE&#34;</span>,
</span></span><span style="display:flex;"><span>  partitionKeys<span style="color:#f92672">=</span>[],
</span></span><span style="display:flex;"><span>  compression<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;snappy&#34;</span>,
</span></span><span style="display:flex;"><span>  enableUpdateCatalog<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>,
</span></span><span style="display:flex;"><span>  transformation_ctx<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;s3output&#34;</span>,
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>s3output<span style="color:#f92672">.</span>setCatalogInfo(
</span></span><span style="display:flex;"><span>  catalogDatabase<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;demo_db&#34;</span>, 
</span></span><span style="display:flex;"><span>  catalogTableName<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;university_ranking_clean&#34;</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>s3output<span style="color:#f92672">.</span>setFormat(<span style="color:#e6db74">&#34;glueparquet&#34;</span>)
</span></span><span style="display:flex;"><span>s3output<span style="color:#f92672">.</span>writeFrame(clean_dynamic_frame)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Commit the job to save state and bookmarks</span>
</span></span><span style="display:flex;"><span>job<span style="color:#f92672">.</span>commit()
</span></span></code></pre></div><h2 id="explanation-of-the-etl-process">Explanation of the ETL Process</h2>
<ol>
<li>
<p><strong>Reading Data</strong>:</p>
<ul>
<li>The script begins by reading the dataset from the Glue Data Catalog into a DynamicFrame.</li>
<li>It prints the schema to help understand the structure of the dataset.</li>
</ul>
</li>
<li>
<p><strong>Transformation</strong>:</p>
<ul>
<li>The dataset is converted to a DataFrame to leverage SQL queries for data transformation.</li>
<li>Key transformations include:
<ul>
<li><strong>Handling Missing Values</strong>: Missing years and scores are replaced with default values (<code>9999</code> for years, <code>-1</code> for scores).</li>
<li><strong>Data Type Consistency</strong>: Fields like <code>rank_display</code> are split and converted into integers.</li>
<li><strong>Cleaning Data</strong>: Fields such as <code>international_students</code> and <code>faculty_count</code> are cleaned by removing non-numeric characters before converting them to integers.</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Writing Data</strong>:</p>
<ul>
<li>The cleaned and transformed data is converted back into a DynamicFrame.</li>
<li>It is then written to an S3 bucket in Parquet format, making it ready for further analysis.</li>
</ul>
</li>
</ol>
<h2 id="conclusion">Conclusion</h2>
<p>This ETL job demonstrates how to address common data quality issues in a dataset using AWS Glue. By handling missing values, ensuring data type consistency, and cleaning the data, we can prepare the dataset for accurate and efficient analysis.</p>





<footer class=" footline" >
	
</footer>

        
        </div> 
        

      </div>

    <div id="navigation">
        
        
        
        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
        
        


	 
	 
		
			<a class="nav nav-prev" href="../3-preparation/3.4-quicksight/" title="Visualizing Data with Amazon QuickSight"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="../5-clean-up/" title="Clean Up Resources" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>
    
    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="../js/clipboard.min.js?1725123472"></script>
    <script src="../js/perfect-scrollbar.min.js?1725123472"></script>
    <script src="../js/perfect-scrollbar.jquery.min.js?1725123472"></script>
    <script src="../js/jquery.sticky.js?1725123472"></script>
    <script src="../js/featherlight.min.js?1725123472"></script>
    <script src="../js/highlight.pack.js?1725123472"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="../js/modernizr.custom-3.6.0.js?1725123472"></script>
    <script src="../js/learn.js?1725123472"></script>
    <script src="../js/hugo-learn.js?1725123472"></script>

    <link href="../mermaid/mermaid.css?1725123472" rel="stylesheet" />
    <script src="../mermaid/mermaid.js?1725123472"></script>
    <script>
        mermaid.initialize({ startOnLoad: true });
    </script>
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-158079754-2', 'auto');
  ga('send', 'pageview');

</script>
  </body>
</html>
